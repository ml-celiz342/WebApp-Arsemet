<h2 class="titulo-pagina">Activos</h2>
<mat-tab-group
  mat-stretch-tabs="false"
  mat-align-tabs="center"
  [selectedIndex]="selectedPage.value"
  (selectedIndexChange)="selectPage($event)"
>
  <mat-tab label="Activos">
    <div class="activos-contenedor">
      <div class="activos-contenedor-filtro">
        <mat-card class="mat-card-custom mat-elevation-z4">
          <div class="filtro-header">
            <span class="filtro-texto">
              <strong>Filtro de estados:</strong>
              <!-- Checkbox Activos/Inactivos -->
              <mat-checkbox
                class="example-margin"
                (change)="toggleChecked('activos')"
                [checked]="isSelected('activos')"
              >
                Habilitados</mat-checkbox
              >
              <mat-checkbox
                class="example-margin"
                (change)="toggleChecked('inactivos')"
                [checked]="isSelected('inactivos')"
                >Deshabilitado</mat-checkbox
              >
            </span>
            <div class="filtro-botones">
              <mat-spinner *ngIf="cargando"></mat-spinner>
              <button mat-icon-button (click)="recargar()" matTooltip="Recargar activos">
                <mat-icon>refresh</mat-icon>
              </button>
              <button mat-icon-button (click)="agregarEditarActivo()" *ngIf="authService.hasPermission('assets','write')" matTooltip="Agregar activo">
                <mat-icon class="agregar-icono">add_circle</mat-icon>
              </button>
            </div>
          </div>
        </mat-card>
      </div>
      <div class="activos-contenedor-tabla">
        <mat-card class="mat-card-custom mat-elevation-z4">
          <div class="activos-contenedor-element">
            <div class="table-wrapper">
              <table mat-table [dataSource]="dataSourceAsset" class="table">
                <!-- Codigo -->
                <ng-container matColumnDef="codigo">
                  <th mat-header-cell *matHeaderCellDef>Código</th>
                  <td mat-cell *matCellDef="let element">
                    {{ element.code }}
                  </td>
                </ng-container>

                <!-- registration -->
                <ng-container matColumnDef="registro">
                  <th mat-header-cell *matHeaderCellDef>Registro</th>
                  <td mat-cell *matCellDef="let element">
                    {{
                      element.registration_date | date : "dd/MM/yyyy HH:mm:ss"
                    }}
                  </td>
                </ng-container>

                <!-- lowdate -->
                <ng-container matColumnDef="lowdate">
                  <th mat-header-cell *matHeaderCellDef>Fecha de baja</th>
                  <td mat-cell *matCellDef="let element">
                    {{ element.low_date | date : "dd/MM/yyyy HH:mm:ss" }}
                  </td>
                </ng-container>

                <!-- type -->
                <ng-container matColumnDef="tipo">
                  <th mat-header-cell *matHeaderCellDef>Tipo activo</th>
                  <td mat-cell *matCellDef="let element">
                    {{ element.type }}
                  </td>
                </ng-container>

            <!-- Acciones -->
            <ng-container matColumnDef="acciones">
              <th mat-header-cell *matHeaderCellDef>Acciones</th>
              <td mat-cell *matCellDef="let element">
                <div class="evidencia-cell">
                  <!-- Botón para Editar -->
                  <button mat-icon-button (click)="agregarEditarActivo(element)" [disabled]="element.low_date"  *ngIf="authService.hasPermission('assets','edit')" matTooltip="Editar activo" >
                    <mat-icon [ngClass]="{'editar-icono': !element.low_date}">edit</mat-icon>
                  </button>
                      <!-- Botón para Eliminar -->
                      <button mat-icon-button (click)="eliminarActivo(element)" [disabled]="element.low_date"   *ngIf="authService.hasPermission('assets','edit')" matTooltip="Deshabilitar activo">
                        <mat-icon [ngClass]="{'eliminar-icono': !element.low_date}">delete</mat-icon>
                      </button>
                    </div>
                  </td>
                </ng-container>

                <tr
                  mat-header-row
                  *matHeaderRowDef="displayedColumnsData"
                  class="table-header"
                ></tr>
                <tr
                  mat-row
                  *matRowDef="let row; columns: displayedColumnsData"
                ></tr>
              </table>
            </div>
             <mat-paginator #paginatorData [pageSizeOptions]="[10, 20]" showFirstLastButtons class="table-paginator"></mat-paginator>
          </div>
        </mat-card>
      </div>
      <!-- Activos -->
      <div class="activos-contenedor-tabla-tipos">
        <mat-card class="mat-card-custom mat-elevation-z4">
          <div class="activos-contenedor-element">
            <div class="table-wrapper">
              <table mat-table [dataSource]="dataSourceTipo" class="table">
                <!-- type -->
                <ng-container matColumnDef="tipo">
                  <th mat-header-cell *matHeaderCellDef>Tipo activo</th>
                  <td mat-cell *matCellDef="let element">
                    {{ element.nombre }}
                  </td>
                </ng-container>

                <!-- Acciones -->
                <ng-container matColumnDef="acciones">
                  <th mat-header-cell *matHeaderCellDef>
                    <div class="acciones-cell">
                      Acciones
                      <button mat-icon-button (click)="agregarEditarTipo()" *ngIf="authService.hasPermission('assets','write')" matTooltip="Agregar tipo de activo">
                        <mat-icon class="agregar-icono">add_circle</mat-icon>
                      </button>
                    </div>
                  </th>
                  <td mat-cell *matCellDef="let element">
                    <div class="acciones-cell">
                      <!-- Botón para Editar -->
                      <button mat-icon-button (click)="agregarEditarTipo(element)" *ngIf="authService.hasPermission('assets','edit')" matTooltip="Editar tipo de activo">
                        <mat-icon class="editar-icono">edit</mat-icon>
                      </button>

                      <!-- Botón para Eliminar -->
                      <button mat-icon-button (click)="eliminarTipo(element)" *ngIf="authService.hasPermission('assets','edit')" matTooltip="Eliminar tipo de activo">
                        <mat-icon class="eliminar-icono">delete</mat-icon>
                      </button>
                    </div>
                  </td>
                </ng-container>

                <tr
                  mat-header-row
                  *matHeaderRowDef="displayedColumnsTipo"
                  class="table-header"
                ></tr>
                <tr
                  mat-row
                  *matRowDef="let row; columns: displayedColumnsTipo"
                ></tr>
              </table>
            </div>
             <mat-paginator #paginatorTipo [hidePageSize]="true" [pageSizeOptions]="[20]" showFirstLastButtons class="table-paginator"></mat-paginator>
          </div>
        </mat-card>
      </div>
    </div>
  </mat-tab>
  <mat-tab label="Activos - Dispositivos">
    <div class="activosdispositivos-contenedor">
      <div class="activosdispositivos-contenedor-filtro">
        <mat-card class="mat-card-custom mat-elevation-z4">
          <div class="filtro-header">
            <span class="filtro-texto">
              <strong>Estados de vínculos:</strong>
              <!-- Checkbox Activos/Inactivos -->
              <mat-checkbox
                class="example-margin"
                (change)="toggleChecked('activos')"
                [checked]="isSelected('activos')"
              >
                Habilitados</mat-checkbox
              >
              <mat-checkbox
                class="example-margin"
                (change)="toggleChecked('inactivos')"
                [checked]="isSelected('inactivos')"
                >Deshabilitados</mat-checkbox
              >
            </span>
            <div class="filtro-botones">
              <mat-spinner *ngIf="cargando"></mat-spinner>
              <button mat-icon-button (click)="recargar()" matTooltip="Recargar vínculos">
                <mat-icon>refresh</mat-icon>
              </button>
              <button mat-icon-button (click)="agregarVinculo()"
              *ngIf="authService.hasPermission('assets','write') && authService.hasPermission('assets','read')  && authService.hasPermission('devices','read')"
              matTooltip="Agregar vínculo">
                <mat-icon class="agregar-icono">add_link</mat-icon>
              </button>
            </div>
          </div>
        </mat-card>
      </div>
      <div class="activosdispositivos-contenedor-tabla">
        <mat-card class="mat-card-custom mat-elevation-z4">
          <div class="activosdispositivos-contenedor-element">
            <div class="table-wrapper">
              <table mat-table [dataSource]="dataSourceAssetDevice" class="table">
                <!-- Codigo -->
                <ng-container matColumnDef="codigo">
                  <th mat-header-cell *matHeaderCellDef>Código activo</th>
                  <td mat-cell *matCellDef="let element">
                    {{ element.codigo }}
                  </td>
                </ng-container>

                <!-- Numero Serie -->
                <ng-container matColumnDef="numero_serie">
                  <th mat-header-cell *matHeaderCellDef>Dispositivo</th>
                  <td mat-cell *matCellDef="let element">
                    {{ element.numero_serie }}
                  </td>
                </ng-container>

                <!-- Fecha Alta -->
                <ng-container matColumnDef="fecha_alta">
                  <th mat-header-cell *matHeaderCellDef>Vinculación</th>
                  <td mat-cell *matCellDef="let element">
                    {{
                      element.fecha_alta | date : "dd/MM/yyyy HH:mm:ss"
                    }}
                  </td>
                </ng-container>

                <!-- Fecha Baja -->
                <ng-container matColumnDef="fecha_baja">
                  <th mat-header-cell *matHeaderCellDef>Desvinculación</th>
                  <td mat-cell *matCellDef="let element">
                    {{
                      element.fecha_baja | date : "dd/MM/yyyy HH:mm:ss"
                    }}
                  </td>
                </ng-container>

                <!-- Acciones -->
                <ng-container matColumnDef="acciones">
                  <th mat-header-cell *matHeaderCellDef>Acciones</th>
                  <td mat-cell *matCellDef="let element">
                    <div class="acciones-cell">
                      <!-- Botón para Eliminar -->
                      <button mat-icon-button (click)="eliminarActivoDispositivo(element)" [disabled]="element.fecha_baja"
                       *ngIf="authService.hasPermission('assets','edit')"
                        matTooltip="Deshabilitar vínculo"
                       >
                        <mat-icon [ngClass]="{'eliminar-icono': !element.fecha_baja}">link_off</mat-icon>
                      </button>
                    </div>
                  </td>
                </ng-container>

                <tr
                  mat-header-row
                  *matHeaderRowDef="displayedColumnsAssetDevice"
                  class="table-header"
                ></tr>
                <tr
                  mat-row
                  *matRowDef="let row; columns: displayedColumnsAssetDevice"
                ></tr>
              </table>
            </div>
            <mat-paginator #paginatorAssetDevice [pageSizeOptions]="[10, 20]" showFirstLastButtons class="table-paginator"></mat-paginator>
          </div>
        </mat-card>
      </div>
    </div>
  </mat-tab>
  <mat-tab label="Activos - Grupos">
    <div class="activosdispositivos-contenedor">
      <div class="activosdispositivos-contenedor-filtro">
        <mat-card class="mat-card-custom mat-elevation-z4">
          <div class="filtro-header">
            <span class="filtro-texto">
              <strong>Estados de vínculos:</strong>
              <!-- Checkbox Activos/Inactivos -->
              <mat-checkbox
                class="example-margin"
                (change)="toggleChecked('activos')"
                [checked]="isSelected('activos')"
              >
                Habilitados</mat-checkbox
              >
              <mat-checkbox
                class="example-margin"
                (change)="toggleChecked('inactivos')"
                [checked]="isSelected('inactivos')"
                >Deshabilitados</mat-checkbox
              >
            </span>
            <div class="filtro-botones">
              <mat-spinner *ngIf="cargando"></mat-spinner>
              <button mat-icon-button (click)="recargar()" matTooltip="Recargar vínculos">
                <mat-icon>refresh</mat-icon>
              </button>
              <button mat-icon-button (click)="agregarVinculoGrupo()"
              *ngIf="authService.hasPermission('assets','write') && authService.hasPermission('assets','read')"
              matTooltip="Agregar vínculo">
                <mat-icon class="agregar-icono">add_link</mat-icon>
              </button>
            </div>
          </div>
        </mat-card>
      </div>
      <div class="activosdispositivos-contenedor-tabla">
        <mat-card class="mat-card-custom mat-elevation-z4">
          <div class="activosdispositivos-contenedor-element">
            <div class="table-wrapper">
              <table mat-table [dataSource]="dataSourceAssetGroup" class="table">
                <!-- Codigo -->
                <ng-container matColumnDef="codigo">
                  <th mat-header-cell *matHeaderCellDef>Código activo</th>
                  <td mat-cell *matCellDef="let element">
                    {{ element.codigo }}
                  </td>
                </ng-container>

                <!-- Codigo -->
                <ng-container matColumnDef="codigo_sub_activo">
                  <th mat-header-cell *matHeaderCellDef>Código sub_activo</th>
                  <td mat-cell *matCellDef="let element">
                    {{ element.sub_codigo }}
                  </td>
                </ng-container>

                <!-- Fecha Alta -->
                <ng-container matColumnDef="fecha_alta">
                  <th mat-header-cell *matHeaderCellDef>Vinculación</th>
                  <td mat-cell *matCellDef="let element">
                    {{
                      element.fecha_alta | date : "dd/MM/yyyy HH:mm:ss"
                    }}
                  </td>
                </ng-container>

                <!-- Fecha Baja -->
                <ng-container matColumnDef="fecha_baja">
                  <th mat-header-cell *matHeaderCellDef>Desvinculación</th>
                  <td mat-cell *matCellDef="let element">
                    {{
                      element.fecha_baja | date : "dd/MM/yyyy HH:mm:ss"
                    }}
                  </td>
                </ng-container>

                <!-- Acciones -->
                <ng-container matColumnDef="acciones">
                  <th mat-header-cell *matHeaderCellDef>Acciones</th>
                  <td mat-cell *matCellDef="let element">
                    <div class="acciones-cell">
                      <!-- Botón para Eliminar -->
                      <button mat-icon-button (click)="eliminarActivoGrupo(element)" [disabled]="element.fecha_baja"
                       *ngIf="authService.hasPermission('assets','edit')"
                        matTooltip="Deshabilitar vínculo"
                       >
                        <mat-icon [ngClass]="{'eliminar-icono': !element.fecha_baja}">link_off</mat-icon>
                      </button>
                    </div>
                  </td>
                </ng-container>

                <tr
                  mat-header-row
                  *matHeaderRowDef="displayedColumnsAssetGroup"
                  class="table-header"
                ></tr>
                <tr
                  mat-row
                  *matRowDef="let row; columns: displayedColumnsAssetGroup"
                ></tr>
              </table>
            </div>
            <mat-paginator #paginatorAssetGroup [pageSizeOptions]="[10, 20]" showFirstLastButtons class="table-paginator"></mat-paginator>
          </div>
        </mat-card>
      </div>
    </div>
  </mat-tab>
</mat-tab-group>
