<h2 class="titulo-pagina">Operarios</h2>
<mat-tab-group
  mat-stretch-tabs="false"
  mat-align-tabs="center"
  [selectedIndex]="selectedPage.value"
  (selectedIndexChange)="selectPage($event)"
>
<mat-tab label="Operarios">
  <div class="operarios-contenedor">
    <div class="operarios-contenedor-filtro">
      <mat-card class="mat-card-custom mat-elevation-z4">
        <div class="filtro-header">
          <span class="filtro-texto">
            <strong>Filtro de estados:</strong>
            <!-- Checkbox Activos/Inactivos -->
            <mat-checkbox
              class="example-margin"
              (change)="toggleChecked('activos')"
              [checked]="isSelected('activos')"
            >
              Habilitados</mat-checkbox
            >
            <mat-checkbox
              class="example-margin"
              (change)="toggleChecked('inactivos')"
              [checked]="isSelected('inactivos')"
              >Deshabilitado</mat-checkbox
            >
          </span>

          <div class="filtro-botones">
            <mat-spinner *ngIf="cargando"></mat-spinner>
            <button
              mat-icon-button
              (click)="recargar()"
              matTooltip="Recargar activos"
            >
              <mat-icon>refresh</mat-icon>
            </button>
            <button
              mat-icon-button
              (click)="agregarEditarOperario()"
              *ngIf="authService.hasPermission('workers', 'write')"
              matTooltip="Agregar operario"
            >
              <mat-icon class="agregar-icono">add_circle</mat-icon>
            </button>
          </div>
        </div>
      </mat-card>
    </div>
    <div class="operarios-contenedor-tabla">
      <mat-card class="mat-card-custom mat-elevation-z4">
        <div class="operarios-contenedor-element">
          <div class="table-wrapper">
            <table mat-table [dataSource]="dataSourceOperarios" class="table">
              <!-- Identificador -->
              <ng-container matColumnDef="identificador">
                <th mat-header-cell *matHeaderCellDef>Itentificador</th>
                <td mat-cell *matCellDef="let element">
                  {{ element.identificador }}
                </td>
              </ng-container>

              <!-- Nombre -->
              <ng-container matColumnDef="nombre">
                <th mat-header-cell *matHeaderCellDef>Nombre</th>
                <td mat-cell *matCellDef="let element">
                  {{ utilities.capitalize(element.nombre) }}
                </td>
              </ng-container>

              <!-- Apellido -->
              <ng-container matColumnDef="apellido">
                <th mat-header-cell *matHeaderCellDef>Apellido</th>
                <td mat-cell *matCellDef="let element">
                  {{ utilities.capitalize(element.apellido) }}
                </td>
              </ng-container>

              <!-- Rfid -->
              <ng-container matColumnDef="rfid">
                <th mat-header-cell *matHeaderCellDef>RFID</th>
                <td mat-cell *matCellDef="let element">
                  {{ element.rfid }}
                </td>
              </ng-container>

              <!-- Sector -->
              <ng-container matColumnDef="sector">
                <th mat-header-cell *matHeaderCellDef>Sector</th>
                <td mat-cell *matCellDef="let element">
                  {{ utilities.capitalize(element.sector) }}
                </td>
              </ng-container>

              <!-- Registro -->
              <ng-container matColumnDef="registro">
                <th mat-header-cell *matHeaderCellDef>Registro</th>
                <td mat-cell *matCellDef="let element">
                  {{ element.registration_date | date : "dd/MM/yyyy HH:mm:ss" }}
                </td>
              </ng-container>

              <!-- lowdate -->
              <ng-container matColumnDef="lowdate">
                <th mat-header-cell *matHeaderCellDef>Fecha de baja</th>
                <td mat-cell *matCellDef="let element">
                  {{ element.low_date | date : "dd/MM/yyyy HH:mm:ss" }}
                </td>
              </ng-container>

              <!-- Acciones -->
              <ng-container matColumnDef="acciones">
                <th mat-header-cell *matHeaderCellDef>Acciones</th>
                <td mat-cell *matCellDef="let element">
                  <div class="evidencia-cell">
                    <!-- Botón para Editar -->
                    <button
                      mat-icon-button
                      (click)="agregarEditarOperario(element)"
                      [disabled]="element.low_date"
                      *ngIf="authService.hasPermission('workers', 'edit')"
                      matTooltip="Editar operario"
                    >
                      <mat-icon [ngClass]="{ 'editar-icono': !element.low_date }"
                        >edit</mat-icon
                      >
                    </button>
                    <!-- Botón para Eliminar -->
                    <button
                      mat-icon-button
                      (click)="eliminarOperario(element)"
                      [disabled]="element.low_date"
                      *ngIf="authService.hasPermission('workers', 'edit')"
                      matTooltip="Deshabilitar operario"
                    >
                      <mat-icon
                        [ngClass]="{ 'eliminar-icono': !element.low_date }"
                        >delete</mat-icon
                      >
                    </button>
                  </div>
                </td>
              </ng-container>

              <tr
                mat-header-row
                *matHeaderRowDef="displayedColumnsData"
                class="table-header"
              ></tr>
              <tr
                mat-row
                *matRowDef="let row; columns: displayedColumnsData"
              ></tr>
            </table>
          </div>
          <mat-paginator
            #paginatorData
            [pageSizeOptions]="[10, 20]"
            showFirstLastButtons
            class="table-paginator"
          ></mat-paginator>
        </div>
      </mat-card>
    </div>
    <!-- Sector -->
    <div class="operarios-contenedor-tabla-sector">
      <mat-card class="mat-card-custom mat-elevation-z4">
        <div class="operarios-contenedor-element">
          <div class="table-wrapper">
            <table mat-table [dataSource]="dataSourceSector" class="table">
              <!-- sector -->
              <ng-container matColumnDef="sector">
                <th mat-header-cell *matHeaderCellDef>Sector</th>
                <td mat-cell *matCellDef="let element">
                  {{ utilities.capitalize(element.nombre) }}
                </td>
              </ng-container>

              <!-- Acciones -->
              <ng-container matColumnDef="acciones">
                <th mat-header-cell *matHeaderCellDef>
                  <div class="acciones-cell">
                    Acciones
                    <button
                      mat-icon-button
                      (click)="agregarEditarSector()"
                      *ngIf="authService.hasPermission('sectors', 'write')"
                      matTooltip="Agregar sector"
                    >
                      <mat-icon class="agregar-icono">add_circle</mat-icon>
                    </button>
                  </div>
                </th>
                <td mat-cell *matCellDef="let element">
                  <div class="acciones-cell">
                    <!-- Botón para Editar -->
                    <button
                      mat-icon-button
                      (click)="agregarEditarSector(element)"
                      *ngIf="authService.hasPermission('sectors', 'edit')"
                      matTooltip="Editar sector"
                    >
                      <mat-icon class="editar-icono">edit</mat-icon>
                    </button>

                    <!-- Botón para Eliminar -->
                    <button
                      mat-icon-button
                      (click)="eliminarSector(element)"
                      *ngIf="authService.hasPermission('sectors', 'edit')"
                      matTooltip="Eliminar sector"
                    >
                      <mat-icon class="eliminar-icono">delete</mat-icon>
                    </button>
                  </div>
                </td>
              </ng-container>

              <tr
                mat-header-row
                *matHeaderRowDef="displayedColumnsSector"
                class="table-header"
              ></tr>
              <tr
                mat-row
                *matRowDef="let row; columns: displayedColumnsSector"
              ></tr>
            </table>
          </div>
          <mat-paginator
            #paginatorSector
            [hidePageSize]="true"
            [pageSizeOptions]="[20]"
            showFirstLastButtons
            class="table-paginator"
          ></mat-paginator>
        </div>
      </mat-card>
    </div>
  </div>
</mat-tab>
<mat-tab label="Operarios - Servicios">
<div class="operarios-contenedor">
  <div class="operarios-contenedor-filtro">
    <mat-card class="mat-card-custom mat-elevation-z4">
      <div class="filtro-header">
        <span class="filtro-texto">
          <strong>Filtro de datos:</strong>
          {{ range.start | date : "dd/MM/yyyy HH:mm:ss" }} -
          {{ range.end | date : "dd/MM/yyyy HH:mm:ss" }}
        </span>
        <div class="filtro-botones">
          <mat-spinner *ngIf="cargando"></mat-spinner>
          <button mat-icon-button matTooltip="Ejecutar" (click)="ejecutar()">
            <mat-icon>play_arrow</mat-icon>
          </button>
          <button mat-icon-button matTooltip="Configurar" (click)="openDialogConfig()">
            <mat-icon>article</mat-icon>
          </button>
          <button mat-icon-button matTooltip="Recargar" (click)="recargar()">
            <mat-icon>refresh</mat-icon>
          </button>
          <button mat-icon-button matTooltip="Aplicar filtros" (click)="openDialog()">
            <mat-icon>filter_list</mat-icon>
          </button>
        </div>
      </div>
    </mat-card>
  </div>
  <div class="operarios-contenedor-servicios">
    <mat-card class="mat-card-custom mat-elevation-z4">
        <div class="table-wrapper">
          <table mat-table [dataSource]="dataSourceEjecucion" matSort class="table">
            <!-- Id -->
            <ng-container matColumnDef="id">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Id</th>
              <td mat-cell *matCellDef="let element">
                {{ element.id }}
              </td>
            </ng-container>

            <!-- cambios -->
            <ng-container matColumnDef="cambios">
              <th mat-header-cell *matHeaderCellDef>Cambios</th>
              <td mat-cell *matCellDef="let element">
                {{ element.cambios }}
              </td>
            </ng-container>

            <!-- Ejecucion -->
            <ng-container matColumnDef="ejecucion">
              <th mat-header-cell *matHeaderCellDef>Ejecución</th>
              <td mat-cell *matCellDef="let element">
                {{ element.ejecucion }}
              </td>
            </ng-container>

            <!-- temporal -->
            <ng-container matColumnDef="temporal">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>Temporal</th>
              <td mat-cell *matCellDef="let element">
                {{ element.temporal | date : "dd/MM/yyyy HH:mm:ss" }}
              </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumnsEjecucion" class="table-header"></tr>
            <tr
              mat-row
              *matRowDef="let row; columns: displayedColumnsEjecucion"
            ></tr>
          </table>
        </div>
        <mat-paginator #paginatorEjecucion [pageSizeOptions]="[10,20,30]" showFirstLastButtons class="table-paginator"></mat-paginator>
    </mat-card>
  </div>
</div>

</mat-tab>
