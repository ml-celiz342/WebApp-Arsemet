<h2 mat-dialog-title>Filtros</h2>
<br />
<mat-dialog-content>
  <div class="form-toggle">
    <mat-slide-toggle [checked]="isActualizar" (change)="checkedEvento($event)">
      Actualización automática
    </mat-slide-toggle>
  </div>

  <mat-form-field appearance="outline" *ngIf="!isActualizar">
    <mat-label>Rango de fechas</mat-label>
    <mat-date-range-input [formGroup]="range" [rangePicker]="picker">
      <input
        matStartDate
        formControlName="start"
        placeholder="Fecha de inicio"
      />
      <input matEndDate formControlName="end" placeholder="Fecha de fin" />
    </mat-date-range-input>
    <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
    <mat-date-range-picker #picker></mat-date-range-picker>
  </mat-form-field>

  <mat-form-field>
    <mat-label>Activos</mat-label>
    <mat-select [formControl]="activos" multiple>
      <mat-select-trigger>
        {{activos.value?.[0] || ''}}
        @if ((activos.value?.length || 0) > 1) {
        <span class="seleccion">
          (+{{ (activos.value?.length || 0) - 1 }} más)
        </span>
        }
      </mat-select-trigger>
      @for (activo of activosList; track activo) {
      <mat-option [value]="activo">{{ activo }}</mat-option>
      }
    </mat-select>
  </mat-form-field>

  <mat-form-field>
    <mat-label>Niveles de alarma</mat-label>
    <mat-select [formControl]="niveles" multiple>
      <mat-select-trigger>
        {{niveles.value?.[0] || ''}}
        @if ((niveles.value?.length || 0) > 1) {
        <span class="seleccion">
          (+{{ (niveles.value?.length || 0) - 1 }} más)
        </span>
        }
      </mat-select-trigger>
      @for (nivel of nivelesList; track nivel) {
      <mat-option [value]="nivel">{{ nivel }}</mat-option>
      }
    </mat-select>
  </mat-form-field>

  <mat-form-field>
    <mat-label>Estado de alarma</mat-label>
    <mat-select [formControl]="estados" multiple>
      <mat-select-trigger>
        {{estados.value?.[0] || ''}}
        @if ((estados.value?.length || 0) > 1) {
        <span class="seleccion">
          (+{{ (estados.value?.length || 0) - 1 }} más)
        </span>
        }
      </mat-select-trigger>
      @for (estado of estadosList; track estado) {
      <mat-option [value]="estado">{{ estado }}</mat-option>
      }
    </mat-select>
  </mat-form-field>

  <mat-form-field>
    <mat-label>Origen de alarma</mat-label>
    <mat-select [formControl]="origenes" multiple>
      <mat-select-trigger>
        {{origenes.value?.[0] || ''}}
        @if ((origenes.value?.length || 0) > 1) {
        <span class="seleccion">
          (+{{ (origenes.value?.length || 0) - 1 }} más)
        </span>
        }
      </mat-select-trigger>
      @for (origen of origenesList; track origen) {
      <mat-option [value]="origen">{{ origen }}</mat-option>
      }
    </mat-select>
  </mat-form-field>
</mat-dialog-content>

<mat-dialog-actions align="end">
  <button mat-button (click)="close()">Cancelar</button>
  <button mat-flat-button color="primary" (click)="applyFilters()">
    Aplicar
  </button>
</mat-dialog-actions>
